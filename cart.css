/* ==========================================================================
   style.css — Mobile-first, iPhone 13 & iPad polish
   Works for both index.html (catalog) and cart.html
   ========================================================================== */

/* ---------- Reset & base ---------- */
*,
*::before,
*::after { box-sizing: border-box; }

html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  height: 100%;
  scroll-behavior: smooth;
}

:root{
  /* Light theme tokens */
  --bg: #ffffff;
  --card: #ffffff;
  --text: #0f172a;
  --muted: #6b7280;
  --border:#e5e7eb;
  --thead:#f7f7f7;
  --thead-2:#fffef7;
  --hover:#fafafa;
  --brand:#0f62fe;
  --brand-ink:#ffffff;
  --danger:#e11d48;
  --shadow: 0 1px 2px rgba(0,0,0,.04), 0 8px 24px rgba(0,0,0,.06);

  /* Rhythm */
  --radius: 16px;
  --radius-sm: 12px;
  --gap: 12px;
  --pad: 12px;
  --maxw: 980px;

  /* Type (≥16px prevents iOS zoom on inputs) */
  --fs-sm: .9rem;
  --fs:    1rem;
  --fs-lg: 1.125rem;
  --lh:    1.45;
}

@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b1020;
    --card:#0f172a;
    --text:#e5e7eb;
    --muted:#a1a1aa;
    --border:#1f2937;
    --thead:#101827;
    --thead-2:#0f172a;
    --hover:#111827;
    --brand:#3b82f6;
    --danger:#ef4444;
    --shadow: 0 6px 24px rgba(0,0,0,.35);
  }
}

body{
  margin:0;
  color:var(--text);
  background:var(--bg);
  font: 500 var(--fs)/var(--lh) system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  min-height:100%;
  padding: env(safe-area-inset-top) var(--pad)
           calc(env(safe-area-inset-bottom) + var(--pad)) var(--pad);
  display:flex;
  justify-content:center;
  overflow-x:hidden; /* never allow horizontal scroll */
}

main, body > header, section, .container { width:100%; max-width:var(--maxw); }

h1{ margin:10px 0 8px; font-weight:700; }
.muted{ color:var(--muted); opacity:.95; font-size:.92rem; }
.muted-sm{ color:var(--muted); font-size:var(--fs-sm); }

img, svg{ max-width:100%; height:auto; }

/* Utilities */
.stack{ display:flex; flex-direction:column; gap:8px; }
.row-gap{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.nowrap-ellipsize{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; min-width:0; }
.full-width-mobile{ width:100%; }
.field-label{ font-size:.8rem; color:var(--muted); }

:where(button,a,input,select,textarea):focus-visible{
  outline:2px solid #38bdf8;
  outline-offset:2px;
  border-radius:10px;
}

/* ---------- Buttons ---------- */
.btn{
  --bgc:#fff;
  --ink:#111827;
  border:1px solid var(--border);
  background:var(--bgc);
  color:var(--ink);
  padding:12px 14px;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
  transition: box-shadow .15s ease, transform .03s ease, background .2s ease, color .2s ease;
  box-shadow: 0 1px 0 rgba(0,0,0,.04);
  line-height:1;
}
.btn:hover{ box-shadow: 0 2px 10px rgba(0,0,0,.06); transform: translateY(-1px); }
.btn:active{ transform: translateY(0); box-shadow:none; }
.btn.primary{ --bgc:var(--brand); --ink:var(--brand-ink); border-color: color-mix(in oklab, var(--brand) 70%, black); }
.btn.danger{  --bgc:#fff0f0; --ink:#9b1c1c; border-color: color-mix(in oklab, var(--danger) 70%, white); }
.btn:disabled{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none; }

/* ---------- Cards ---------- */
.card{
  border:1px solid var(--border);
  border-radius:var(--radius);
  background:var(--card);
  box-shadow:var(--shadow);
  padding:12px;
}
.card > header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }

/* ---------- Floating cart FAB ---------- */
.cart-fab{
  position: fixed;
  top: max(12px, env(safe-area-inset-top));
  right: max(12px, env(safe-area-inset-right));
  z-index: 10000;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: var(--brand);
  color: #fff;
  border: none;
  border-radius: 999px;
  padding: 10px 14px;
  box-shadow: 0 6px 24px rgba(15, 98, 254, .25);
  cursor: pointer;
}
.cart-fab .badge{
  min-width: 22px; height: 22px; padding: 0 6px;
  border-radius: 999px; background:#fff; color:#111827;
  font-weight:700; display:inline-flex; align-items:center; justify-content:center; font-size:.85rem;
}

/* ---------- Controls (catalog) ---------- */
#controls{
  display:grid;
  grid-template-columns: 1fr 220px 200px 120px;
  gap: var(--gap);
  align-items:center;
  margin: 10px 0;
}
input[type="search"], select, input[type="number"]{
  width:100%;
  min-width:0;
  padding:12px;
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--bg);
  color:var(--text);
  font-size:16px; /* stop iOS zoom */
}
input[type="search"]:disabled, select:disabled, button:disabled{ opacity:.6; cursor:not-allowed; }

/* ---------- Chips scroller ---------- */
.chips{ display:flex; gap:8px; flex-wrap:nowrap; align-items:center; padding:8px 6px; }
.scroller{ overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:thin; border:1px dashed var(--border); border-radius:12px; margin:8px 0 12px; }
.chip{ white-space:nowrap; padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:#fff; cursor:pointer; user-select:none; font-size:.92rem; }
.chip.active{ background:var(--brand); color:#fff; border-color:var(--brand); }

/* ---------- Product table ---------- */
#table-container{ margin-top:10px; }
table{ width:100%; border-collapse:collapse; }
thead th{
  background:var(--thead);
  position:sticky; top:0; z-index:1;
  text-align:left; padding:10px; border-bottom:1px solid var(--border);
  font-weight:700; font-size:.95rem;
}
tbody td{ padding:8px 10px; border-bottom:1px solid #eee; vertical-align:middle; }
tbody tr:hover{ background:var(--hover); }
tbody tr:last-child td { border-bottom: none; }
.qty-input{ width:90px; padding:10px; border:1px solid var(--border); border-radius: 10px; }

/* ---------- Cart section ---------- */
#cart-section{ margin:18px 0; overflow:hidden; scroll-margin-top: 80px; }
#cart-section header{
  display:flex; justify-content:space-between; align-items:center;
  background:var(--thead); border-bottom:1px solid var(--border);
  padding:10px 12px; border-top-left-radius:8px; border-top-right-radius:8px;
}
/* Cart table */
#cart-table { width:100%; border-collapse:collapse; }
#cart-table thead th{ background:var(--thead-2); }
#cart-table tbody td { font-size:.95rem; }
.cell-text{ display:block; min-width:0; }

/* Hide "Unit (Sell +…)" on larger screens too if you want a cleaner cart */
#cart-table thead th:nth-child(5),
#cart-table tbody td:nth-child(5){ display:none; }

/* ---------- Labor block ---------- */
#labor-list{ display:grid; gap:12px; margin-top:12px; }
#labor-list .labor-head{
  display:flex; justify-content:space-between; align-items:center;
  padding-bottom:6px; border-bottom:1px dashed var(--border);
}
#labor-list .labor-row{
  display:grid; grid-template-columns: repeat(4, 1fr);
  gap:12px; border:1px solid var(--border); border-radius:16px; background:var(--card); padding:12px;
}
#labor-list .labor-row .field{ display:grid; gap:6px; }
#labor-list .labor-row .field:last-child{ align-self:end; }

/* ---------- Totals ---------- */
#totals{
  display:grid; grid-template-columns: 1fr auto;
  gap:10px; align-items:center; padding:12px; border-top:1px dashed var(--border);
}
#totals .label{ color:var(--muted); font-weight:700; text-align:right; padding-right:8px; }
#totals .value{ font-variant-numeric: tabular-nums; }
#totals .label.grand, #totals .value.grand{ font-weight:800; font-size: calc(var(--fs-lg) + .05rem); }

/* ---------- Toast ---------- */
#toast{
  position:fixed; right:16px;
  bottom: calc(env(safe-area-inset-bottom) + 16px);
  background: rgba(17,24,39,.96); color:#fff;
  padding:10px 12px; border-radius:12px; font-size:var(--fs);
  line-height:1; box-shadow:var(--shadow);
  opacity:0; visibility:hidden; transform: translateY(8px);
  transition: opacity .25s ease, transform .25s ease, visibility .25s ease;
  z-index:9999;
}
#toast.show{ opacity:1; visibility:visible; transform:translateY(0); }

/* ==========================================================================
   Mobile (phones, incl. iPhone 13/12 390px portrait)
   ========================================================================== */
@media (max-width: 720px){
  /* Header & controls stack nicely */
  h1{ text-align:center; font-size:1.25rem; margin:8px 0; }
  #controls{
    grid-template-columns: 1fr;
    position: sticky;
    top: calc(56px + env(safe-area-inset-top));
    z-index: 900;
    background: color-mix(in oklab, var(--card) 92%, transparent);
    backdrop-filter: saturate(1.05) blur(6px);
    border:1px solid var(--border);
    box-shadow:var(--shadow);
  }

  #categoryChips{
    position: sticky;
    top: calc(56px + env(safe-area-inset-top) + 140px);
    z-index:800;
    background: linear-gradient(var(--card), color-mix(in oklab, var(--card) 96%, transparent));
    border:1px dashed var(--border);
    border-radius:12px;
    margin-top:8px;
  }

  /* Product table → cards */
  #table-container { overflow:visible; }
  #data-table, #data-table tbody, #data-table tr, #data-table td{ display:block; width:100%; }
  #data-table thead{ display:none; }
  #data-table tbody tr{
    border:1px solid var(--border);
    border-radius:16px;
    padding:10px 10px 12px;
    margin:10px auto;
    background:var(--card);
    box-shadow:var(--shadow);
    max-width:640px;
  }
  #data-table tbody td{
    border:none;
    display:flex; justify-content:space-between; gap:10px; padding:8px 6px;
  }
  #data-table tbody td::before{ content: attr(data-label); color:var(--muted); font-weight:700; }
  .qty-input{ width:76px; }

  /* Cart rows → cards */
  #cart-table thead{ display:none; }
  #cart-table, #cart-table tbody, #cart-table tr, #cart-table td{ display:block; width:100%; }
  #cart-table tbody tr{
    border:1px solid var(--border);
    border-radius:16px;
    background:var(--card);
    box-shadow:var(--shadow);
    padding:10px;
    margin:10px auto;
    max-width:640px;
  }
  #cart-table tbody td{
    border:none;
    display:grid;
    grid-template-columns: 114px 1fr; /* label | content */
    gap:8px; padding:8px 6px; min-width:0;
  }
  #cart-table tbody td::before{ content: attr(data-label); color:var(--muted); font-weight:700; }
  #cart-table tbody td .cell-text{ overflow:hidden; text-overflow:ellipsis; }

  /* Keep the QTY cell cleaner (hide auto label) */
  #cart-table tbody td[data-label="Qty"]{ grid-template-columns: 1fr; }
  #cart-table tbody td[data-label="Qty"]::before{ content:""; display:none; }

  /* Hide heavy columns on phones */
  #cart-table tbody td[data-label="Vendor"],
  #cart-table tbody td[data-label="SKU"],
  #cart-table tbody td[data-label="Unit"]{ display:none; }

  /* Labor grid → 2 columns */
  #labor-list .labor-row{ grid-template-columns: 1fr 1fr; }
  #labor-list .labor-row .field:last-child{ justify-self:end; }

  /* Allow primary actions to stretch */
  .full-width-mobile{ width:100%; }
}

/* ==========================================================================
   iPad polish (portrait + landscape)
   - Looser density than desktop, denser than phone
   ========================================================================== */
@media (min-width: 768px) and (max-width: 1024px){
  body{ padding-left:max(var(--pad), env(safe-area-inset-left)); padding-right:max(var(--pad), env(safe-area-inset-right)); }
  #controls{ grid-template-columns: 1.2fr 0.8fr 0.8fr 0.6fr; }
  .qty-input{ width:84px; }
  #labor-list .labor-row{ grid-template-columns: repeat(4, 1fr); }
}

/* ==========================================================================
   Sticky bottom action bar (phones)
   ========================================================================== */
@media (max-width: 720px){
  .sticky-actions{
    position: sticky;
    bottom: 0;
    z-index: 950;
    background: color-mix(in oklab, var(--card) 98%, transparent);
    backdrop-filter: saturate(1.05) blur(6px);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 10px;
    margin-top: 8px;
    box-shadow: var(--shadow);
  }
}

/* === Mobile cart fixes (place at end of style.css) === */

/* 1) Don't clip buttons/cards inside the cart */
#cart-section { overflow: visible; }

/* 2) Friendlier card layout for cart rows on small screens */
@media (max-width: 720px){
  /* Cell = [label | content]; give labels a narrower, fixed rail */
  #cart-table tbody td{
    grid-template-columns: 110px 1fr;   /* was ~42%/58% */
    align-items: start;
    padding: 10px 12px;                 /* a little more right padding */
  }

  /* Quantity cell keeps its special stacking */
  #cart-table tbody td[data-label="Qty"]{
    grid-template-columns: 1fr;
  }
  #cart-table tbody td[data-label="Qty"]::before{
    content:""; display:none;
  }

  /* Actions cell: just the button, don’t force a label rail */
  #cart-table tbody td[data-label="Actions"]{
    grid-template-columns: 1fr;
    justify-items: end;
  }

  /* 3) Stop “Description … P/S” shards — let text wrap, left-align values */
  #cart-table tbody td .cell-text{
    white-space: normal;         /* allow wrapping */
    overflow: visible;
    text-overflow: clip;
    text-align: left;            /* was right-aligned */
  }

  /* 4) Keep buttons inside the card bounds */
  #cart-table tbody td .btn{
    max-width: 100%;
  }
}

/* --- Improved "Continue Browsing" button modifiers --- */
.btn--ghost {
  background: transparent;
  color: var(--text, #111);
  border: 1px solid var(--border, rgba(0,0,0,.15));
}

.btn--back {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;              /* >= 44px touch height via your .btn baseline */
  border-radius: 9999px;           /* pill shape */
  font-weight: 600;
  line-height: 1.1;
  box-shadow: 0 0 0 0 transparent;
}

.btn--back .btn__icon {
  display: inline-flex;
  inline-size: 18px;
  block-size: 18px;
}

.btn--back:hover {
  background: color-mix(in oklab, var(--brand, #2563eb) 6%, transparent);
  border-color: color-mix(in oklab, var(--brand, #2563eb) 35%, var(--border, rgba(0,0,0,.15)));
}

.btn--back:active {
  transform: translateY(1px);
}

.btn--back:focus-visible {
  outline: 3px solid color-mix(in oklab, var(--brand, #2563eb) 60%, white);
  outline-offset: 2px;
  box-shadow: 0 6px 18px rgba(0,0,0,.10);
}

@media (prefers-reduced-motion: no-preference) {
  .btn--back {
    transition: background-color .2s, border-color .2s, transform .06s, box-shadow .2s;
  }
}

/* Dark-mode friendly tweaks if you use a dark theme */
@media (prefers-color-scheme: dark) {
  .btn--ghost {
    color: var(--text, #f5f5f5);
    border-color: color-mix(in oklab, var(--border, rgba(255,255,255,.25)) 70%, transparent);
  }
  .btn--back:hover {
    background: color-mix(in oklab, var(--brand, #60a5fa) 10%, transparent);
    border-color: color-mix(in oklab, var(--brand, #60a5fa) 45%, var(--border, rgba(255,255,255,.25)));
  }
  .btn--back:focus-visible {
    outline: 3px solid color-mix(in oklab, var(--brand, #60a5fa) 70%, white);
  }
}
/* Hide text when the button is icon-only */
.btn--icon-only .btn__text { display: none; }
.btn--icon-only { gap: 0; padding: 10px; } /* tighten spacing since there's no text */
